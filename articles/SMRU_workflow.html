<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SMRU_workflow • ArgosQC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SMRU_workflow">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ArgosQC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9-144</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/SMRU_config_file.html">SMRU_config_file</a>
    </li>
    <li>
      <a href="../articles/WC_config_file.html">WC_config_file</a>
    </li>
    <li>
      <a href="../articles/SMRU_workflow.html">SMRU_workflow</a>
    </li>
    <li>
      <a href="../articles/WC_workflow.html">WC_workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/ianjonsen/ArgosQC" class="external-link">
    <span class="fa fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SMRU_workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ianjonsen/ArgosQC/blob/main/vignettes/SMRU_workflow.Rmd" class="external-link"><code>vignettes/SMRU_workflow.Rmd</code></a></small>
      <div class="hidden name"><code>SMRU_workflow.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="smru-srdl-tag-qc-workflow">SMRU SRDL tag QC workflow<a class="anchor" aria-label="anchor" href="#smru-srdl-tag-qc-workflow"></a>
</h2>
<p>The first step to initiate any <code>ArgosQC</code> workflow is to
construct a <code>JSON</code> config file (see <a href="SMRU_config_file.html">SMRU_config_file</a>).</p>
<p>The SMRU SRDL tag QC workflow has a number of data/metadata
processing, model fitting, data file annotation and output steps. Each
of these steps is encapsulated in an ArgosQC function:</p>
<p>Table 1. SMRU SRDL tag QC workflow functions listed in order of
operation. For standard near real-time (NRT) QC workflows, these
functions are implemented via the wrapper function,
<code><a href="../reference/smru_qc.html">smru_qc()</a></code>. For examples of how to implement the individual
functions refer to the R help pages, e.g., type
<code><a href="../reference/download_data.html">?download_data</a></code> in the R console.</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th align="center">SMRU QC function</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><code>download_data</code></td>
<td align="center">Downloads tag data .mdb file from SMRU server &amp;
writes to the specified <code>data.dir</code>.</td>
</tr>
<tr class="even">
<td align="center"><code>smru_pull_tables</code></td>
<td align="center">Extracts tag data files from the downloaded .mdb file
to a named list object in the R workspace, See
<code><a href="../reference/smru_pull_tables.html">?smru_pull_tables</a></code> for an example.</td>
</tr>
<tr class="odd">
<td align="center"><code>get_metadata</code></td>
<td align="center">Either loads deployment metadata from a CSV file
specified in the <code>config</code> file <code>setup</code> block, or
builds the metadata from the tag manufacturer’s data portal in
combination with species and deployment site attributes provided in the
<code>config</code> file <code>meta</code> block.</td>
</tr>
<tr class="even">
<td align="center"><code>smru_prep_loc</code></td>
<td align="center">Prepares location data for SSM fitting by
restructuring the SMRU diag &amp; gps (if present) tag data files,
truncating start and end dates (for NRT QC) based on dates of first
&amp; last CTD profile, projecting locations from lon-lat to the
<code>config</code> file specified proj4string.</td>
</tr>
<tr class="odd">
<td align="center"><code>multi_filter</code></td>
<td align="center">Applies a 1st pass of the SSM model using parameters
specified in the <code>config</code> file <code>model</code> block.
SSM’s are fit in parallel across n available processors.</td>
</tr>
<tr class="even">
<td align="center"><code>redo_multi_filter</code></td>
<td align="center">Applies a 2nd pass to refit the SSM to any tag
location datasets that failed to converge on the first pass. Uses
automatically revised parameters to help ensure convergence. Reroutes
any locations off of land, if <code>model:reroute:true</code> in
<code>config</code> file.</td>
</tr>
<tr class="odd">
<td align="center"><code>ssm_mark_gaps</code></td>
<td align="center">Identifies &amp; marks SSM predicted &amp; rerouted
locations in track segments with data gaps of a specified minimum
duration. Typically used in DM QC’s only.</td>
</tr>
<tr class="even">
<td align="center"><code>smru_append_ssm</code></td>
<td align="center">Appends SMRU tag data files with SSM-derived
coordinates &amp; uncertainty (lon,lat,x,y, x.se, y.se) for each
record.</td>
</tr>
<tr class="odd">
<td align="center"><code>smru_clean_diag</code></td>
<td align="center">Restructures the diag file for diagnostic plots</td>
</tr>
<tr class="even">
<td align="center"><code>diagnostics</code></td>
<td align="center">Generates a map of all QC’d tracks &amp; time-series
plots of longitude &amp; latitude for quick assessment of SSM fit to the
tag location datasets.</td>
</tr>
<tr class="odd">
<td align="center"><code>smru_write_csv</code></td>
<td align="center">Combines QC-annotated tag data files across
individual tags, applies tests for expected variables types and ranges
(IMOS only for now), writes data files to CSV as final QC outputs</td>
</tr>
</tbody>
</table>
<p>If a more complicated NRT workflow is required, e.g., with custom
processing in between the standard workflow steps, the functions can be
called separately from an R script so that intermediate results can be
checked. This is also the recommended approach for all delayed-mode
(supervised) QC workflows.</p>
<p>In this example, the main QC outputs were written to .CSV files in
the specified output directory, <code>output.dir</code>. Each .CSV file
includes the name of the SMRU data table, when present
(<code>ctd</code>, <code>diag</code>, <code>dive</code>,
<code>haulout</code>, <code>summary</code>) or the QC file
(<code>metadata</code>, <code>ssmoutputs</code>). For QC workflows with
ATN data, each of these file names is appended with the species’
<code>AnimalAphiaID</code> and the <code>ADRProjectID</code>. For IMOS
and other programs, the file names are appended with the SMRU campaign
ID (e.g., <code>ct182</code>).</p>
<p>The diag files show the SSM fit (red) overlaid on the tag-measured
Argos &amp;/or GPS locations (blue). The dark grey vertical bars denote
the time period tags were actively recording locations but the seal(s)
either had not yet gone to sea (no recorded diving activity - left
side), or the CTD sensor had failed (e.g., grey bar on right side of
<code>tu123-Catherine-25</code>). By default, the QC model does not fit
to data in these time periods. These plots help judge whether the SSM
fits have artefacts that need addressing - typically only addressed
during a delayed-mode QC workflow. <img src="images/lat_coverage_tu123.jpg" style="width:100.0%"></p>
<p>The map file shows the SSM-predicted tracks (blue) and current last
estimated location (red) for each deployed tag. The map files are
annotated by the QC date so they are not overwritten by successive QC
runs. <img src="images/map_tu123_2025-11-10.jpg" style="width:100.0%"></p>
<div class="section level4">
<h4 id="output--csv-files">Output .CSV files<a class="anchor" aria-label="anchor" href="#output--csv-files"></a>
</h4>
<p>The QC’s main outputs, the .CSV files contain all records from the
original SMRU data tables and are appended with the following additional
columns: <code>ssm_lat</code>, <code>ssm_lon</code>, <code>ssm_x</code>,
<code>ssm_y</code>, <code>ssm_x_se</code>, <code>ssm_y_se</code>. These
are the QC’d locations and their uncertainty estimates interpolated to
the time of each record. The <code>ssm_x</code>, <code>ssm_y</code>
variables are the coordinates from the QC workflow projection (in km)
and <code>ssm_x_se</code>, <code>ssm_y_se</code> are the associated
standard errors (in km). Note that NA’s may be present in the
QC-appended location variables, particularly at the start and/or end of
individual tracks. This is typically indicative of track portions prior
to animals going to sea (at deployment start) and portions when either
the CTD or pressure sensor failed, eg. due to biofouling or seawater
ingress, but tag still transmitted locations (near deployment end).</p>
</div>
<div class="section level4">
<h4 id="metadata--csv-file">Metadata .CSV file<a class="anchor" aria-label="anchor" href="#metadata--csv-file"></a>
</h4>
<p>If an input deployment/tag metadata file is provided then the output
metadata file contains all the original metadata records plus the
following variables describing the QC workflow applied to the data:</p>
<ul>
<li>
<code>qc_start_date</code> - the track datetime (UTC) at which the
QC workflow was started.</li>
<li>
<code>qc_end_date</code> - the track datetime (UTC) at which the QC
workflow was ended.</li>
<li>
<code>qc_proj4string</code> - the projection used for QC’ing the
locations, as a proj4string.</li>
<li>
<code>qc_method</code> - denotes the <code>ArgosQC</code> R package
was used.</li>
<li>
<code>qc_version</code> - denotes the version number of the
<code>ArgosQC</code> R package used.</li>
<li>
<code>qc_run_date</code> - the datetime (UTC) when the QC was
applied to the data.</li>
</ul>
<p>Note, these variables are not appended to the metadata for IMOS QC
workflows due to IMOS - AODN metadata specifications.</p>
</div>
<div class="section level4">
<h4 id="ssmoutputs--csv-file">SSMOutputs .CSV file<a class="anchor" aria-label="anchor" href="#ssmoutputs--csv-file"></a>
</h4>
<p>The SSMOutputs file contains the SSM-predicted locations at the
<code>time.step</code> specified prediction interval. The time of the
first location is set to the time of the first tag-measured location
passed to the model. This may or may not be the first tag-measured
location in the tag datafile, depending on whether the animal-borne tag
was immediately at sea. The location coordinates are provided as:
<code>lon</code>, <code>lat</code>, <code>x</code>, <code>y</code>, and
location uncertainty as <code>x_se</code>, <code>y_se</code>. The planar
coordinates and uncertainty estimates always have units in km. Their
coordinate projection is provided in the metadata .CSV file
(<code>qc_proj4string</code>).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ian Jonsen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
